
pkgname=php-phalcon
version=4.1.0
revision=2
depends="php php-psr"
makedepends="php-devel autoconf"
short_desc="php extension web framework written with zephir, C compiled"
distfiles=https://github.com/phalcon/cphalcon/archive/v${version}.zip
checksum=a3bb2a0a5d7e99f41021f017d6b0064fb981e4c954fe9ca07d52be01513ffede
homepage="https://https://phalcon.io/"
license="PHP-3.01"
maintainer="Michael Rynn <michael.rynn.500@gmail.com>"

lib32disabled=yes
create_wrksrc=yes
archs="x86_64"

srcpath=cphalcon-${version}/build/php7/64bits
inipath=/etc/php/conf.d

do_build() {  

  export CPPFLAGS="-DPHALCON_RELEASE"
  cd ${wrksrc}/${srcpath}
  phpize
  cd build
  ../configure --prefix=/usr --enable-phalcon
  make
}

do_install() {
  cd ${wrksrc}/${srcpath}/build
  echo 'extension=phalcon' > phalcon.ini
  vmkdir ${inipath}
  vinstall phalcon.ini 644 ${inipath}
  vinstall modules/phalcon.so 755 /usr/lib/php/modules
}

